import{b as H,s as V,R as A,j as e,P as d,r}from"./index-30c7ff2b.js";import{W as J}from"./WebcamModal-98639094.js";const G="https://api.data.gov.sg/v1/transport/traffic-images",X={1701:{name:"Woodlands Causeway",area:"Causeway"},1702:{name:"Woodlands Checkpoint",area:"Checkpoint"},1703:{name:"BKE Woodlands Flyover",area:"BKE"},1704:{name:"BKE Dairy Farm Flyover",area:"BKE"},1705:{name:"BKE Sungei Kadut Flyover",area:"BKE"},1706:{name:"BKE Mandai Flyover",area:"BKE"},1707:{name:"KJE BC Exit",area:"KJE"},1709:{name:"Changi Airport",area:"Changi"},2701:{name:"Sentosa Gateway",area:"Sentosa"},2702:{name:"West Coast Highway",area:"West Coast"},2703:{name:"ECP Marina Bay",area:"Marina Bay"},2704:{name:"Orchard Boulevard",area:"Orchard"},2705:{name:"Marina Coastal Drive",area:"Marina"},2706:{name:"ECP Fort Road",area:"ECP"},2707:{name:"Fullerton Road",area:"CBD"},2708:{name:"Marina Boulevard",area:"Marina"},3701:{name:"Central Boulevard",area:"CBD"},3702:{name:"PIE Tuas",area:"PIE"},3704:{name:"PIE Kim Keat",area:"PIE"},3705:{name:"PIE Eunos",area:"PIE"},4701:{name:"AYE After Tuas",area:"AYE"},4702:{name:"AYE Keppel",area:"AYE"},4703:{name:"TPE Punggol",area:"TPE"},4704:{name:"TPE Seletar",area:"TPE"},4705:{name:"TPE Sengkang",area:"TPE"},4706:{name:"TPE Tampines",area:"TPE"},4707:{name:"CTE Braddell",area:"CTE"},4708:{name:"CTE Ang Mo Kio",area:"CTE"},4709:{name:"CTE Yishun",area:"CTE"},4710:{name:"Tuas Second Link",area:"Tuas"},4712:{name:"MCE Marina Bay",area:"MCE"},4713:{name:"MCE Maxwell",area:"MCE"},4714:{name:"MCE MBFC",area:"MCE"},4716:{name:"MCE Bayfront",area:"MCE"},5794:{name:"EMAS Woodlands",area:"North"},5795:{name:"EMAS Yishun",area:"North"},5796:{name:"EMAS Bishan",area:"Central"},5797:{name:"EMAS Bukit Panjang",area:"West"},5798:{name:"EMAS Jurong",area:"West"},5799:{name:"Tuas View Extension",area:"Tuas"},6701:{name:"BKE Chantek Flyover",area:"BKE"},6702:{name:"PIE Mount Pleasant",area:"PIE"},6703:{name:"PIE Woodsville",area:"PIE"},6704:{name:"PIE Bedok North",area:"PIE"},6705:{name:"PIE Eunos Flyover",area:"PIE"},6706:{name:"PIE Paya Lebar",area:"PIE"},6708:{name:"PIE Toa Payoh",area:"PIE"},6710:{name:"PIE Bukit Timah",area:"PIE"},6711:{name:"PIE Clementi",area:"PIE"},6712:{name:"PIE Jurong",area:"PIE"},6713:{name:"PIE Bukit Batok",area:"PIE"},6714:{name:"PIE BKE",area:"PIE"},6715:{name:"PIE Tuas Flyover",area:"PIE"},6716:{name:"PIE Nanyang Flyover",area:"PIE"},7791:{name:"Woodlands Avenue 12",area:"Woodlands"},7793:{name:"Loyang Avenue",area:"East"},7794:{name:"Upp Changi Road",area:"East"},7795:{name:"Changi Coast Road",area:"East"},7796:{name:"Tanah Merah Coast",area:"East"},7797:{name:"ECP Changi Link",area:"ECP"},7798:{name:"Marine Parade Road",area:"East Coast"},8701:{name:"AYE MCE",area:"AYE"},8702:{name:"SLE Lentor",area:"SLE"},8704:{name:"SLE Marsiling",area:"SLE"},8706:{name:"SLE Woodlands South",area:"SLE"},9701:{name:"Admiralty Road",area:"North"},9702:{name:"Upp Thomson Road",area:"Central"},9703:{name:"SLE Mandai Lake",area:"SLE"},9704:{name:"SLE Seletar",area:"SLE"},9705:{name:"TPE Pasir Ris",area:"TPE"},9706:{name:"Loyang Avenue Flyover",area:"East"}},Q=async(a={})=>{try{const n=await H.fetch(G,{cacheTTL:a.cacheTTL||6e4,timeout:a.timeout||15e3,headers:{Accept:"application/json","User-Agent":"Singapore-Weather-Cam/1.0"}});if(!n||typeof n!="object")throw new Error("Invalid API response format");if(!n.items||!Array.isArray(n.items)||n.items.length===0)throw new Error("No traffic camera data available");const s=n.items[0];if(!s.cameras||!Array.isArray(s.cameras))throw new Error("Invalid camera data structure");const{timestamp:u,cameras:y}=s,x=y.filter(t=>t.camera_id&&t.location&&t.image&&typeof t.location.latitude=="number"&&typeof t.location.longitude=="number").map(t=>{var o,c,p;const h=X[t.camera_id]||{name:`Camera ${t.camera_id}`,area:"Unknown"},g={id:t.camera_id,name:h.name,area:h.area,location:{latitude:parseFloat(t.location.latitude),longitude:parseFloat(t.location.longitude)},image:{url:t.image,width:((o=t.image_metadata)==null?void 0:o.width)||0,height:((c=t.image_metadata)==null?void 0:c.height)||0,md5:((p=t.image_metadata)==null?void 0:p.md5)||null},timestamp:t.timestamp,quality:Z(t.image_metadata),status:"active"},b=V.validateCameraData(g);return b.isValid?b.sanitized:(console.warn(`Camera ${t.camera_id} validation failed:`,b.errors),null)}).filter(t=>t!==null);return console.log(`ğŸ“Š Traffic Cameras: ${x.length} cameras processed`),{timestamp:u,totalCameras:x.length,cameras:x,metadata:{fetchTime:new Date().toISOString(),source:"data.gov.sg",cacheHit:!1,processingTime:Date.now()-(a.startTime||Date.now())}}}catch(n){console.error("Error fetching traffic cameras:",n);const s=new Error(`Traffic camera fetch failed: ${n.message}`);throw s.originalError=n,s.service="traffic-cameras",s.timestamp=new Date().toISOString(),s}};function Z(a){if(!a)return"unknown";const{width:n,height:s}=a;return n>=1920&&s>=1080?"HD":n>=1280&&s>=720?"HD Ready":n>=640&&s>=480?"Standard":"Low"}const ee=(a,n)=>!n||n==="all"?a:a.filter(s=>s.area.toLowerCase().includes(n.toLowerCase())),ae=a=>a.reduce((n,s)=>(n[s.area]||(n[s.area]=[]),n[s.area].push(s),n),{}),se=a=>{const n=["2703","2704","1701","4712","2701","1709","4710","6716"];return a.filter(s=>n.includes(s.id))},B=A.memo(({delay:a=0})=>e.jsxs("div",{className:"card animate-pulse",style:{animationDelay:`${a}ms`,animationDuration:"1.5s"},role:"status","aria-label":"Loading camera",children:[e.jsxs("div",{className:"aspect-video bg-gray-200 rounded overflow-hidden mb-3 relative",children:[e.jsx("div",{className:"skeleton w-full h-full"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]}),e.jsx("div",{className:"skeleton h-4 w-3/4 mb-2 rounded"}),e.jsx("div",{className:"skeleton h-3 w-1/2 mb-3 rounded"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"skeleton h-3 w-16 rounded"}),e.jsx("div",{className:"skeleton h-3 w-20 rounded"})]}),e.jsx("span",{className:"sr-only",children:"Loading camera information"})]})),$=A.memo(()=>e.jsxs("div",{className:"card animate-pulse",role:"status","aria-label":"Loading controls",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"skeleton h-8 w-20 rounded"}),e.jsx("div",{className:"skeleton h-8 w-16 rounded"}),e.jsx("div",{className:"skeleton h-8 w-14 rounded"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"skeleton h-6 w-24 rounded"}),e.jsx("div",{className:"skeleton h-8 w-20 rounded"})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"skeleton h-3 w-48 rounded"})}),e.jsx("span",{className:"sr-only",children:"Loading gallery controls"})]})),F=A.memo(()=>e.jsxs("div",{className:"card animate-pulse",role:"status","aria-label":"Loading summary",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"skeleton h-4 w-40 rounded"}),e.jsx("div",{className:"skeleton h-4 w-32 rounded"})]}),e.jsx("span",{className:"sr-only",children:"Loading camera summary"})]})),P=({count:a=8,showControls:n=!0,showSummary:s=!0,variant:u="default"})=>{const y=()=>u==="compact"?"grid-cols-1 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6":u==="minimal"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",x=t=>{const h=Math.floor(t/4)*100,g=t%4*50;return h+g};return e.jsxs("div",{className:"space-y-6",role:"region","aria-label":"Loading camera gallery",children:[n&&e.jsx($,{}),e.jsx("div",{className:`grid ${y()} gap-4`,children:Array.from({length:a},(t,h)=>e.jsx(B,{delay:x(h)},`skeleton-${h}`))}),s&&e.jsx(F,{}),e.jsxs("div",{className:"sr-only",role:"status","aria-live":"polite","aria-atomic":"true",children:["Loading camera gallery with ",a," items. Please wait..."]})]})};P.CameraCard=B;P.Controls=$;P.Summary=F;B.displayName="CameraCardSkeleton";$.displayName="ControlsSkeleton";F.displayName="SummarySkeleton";P.displayName="LoadingSkeleton";const M=({error:a,onRetry:n,retryAttempts:s=0,maxRetries:u=3,showDetails:y=!1,variant:x="default"})=>{const[t,h]=r.useState(!1),[g,b]=r.useState(y),c=(m=>{const i=(m==null?void 0:m.toLowerCase())||"";return i.includes("network")||i.includes("fetch")?{type:"network",title:"ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì˜¤ë¥˜",message:"ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",icon:"ğŸŒ",severity:"error"}:i.includes("timeout")?{type:"timeout",title:"ìš”ì²­ ì‹œê°„ ì´ˆê³¼",message:"ì„œë²„ ì‘ë‹µì´ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",icon:"â±ï¸",severity:"warning"}:i.includes("404")||i.includes("not found")?{type:"not_found",title:"ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ",message:"ìš”ì²­í•œ ì¹´ë©”ë¼ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",icon:"ğŸ”",severity:"warning"}:i.includes("403")||i.includes("unauthorized")?{type:"unauthorized",title:"ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ",message:"ë°ì´í„°ì— ì ‘ê·¼í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.",icon:"ğŸ”’",severity:"error"}:i.includes("500")||i.includes("server")?{type:"server",title:"ì„œë²„ ì˜¤ë¥˜",message:"ì„œë²„ì— ì¼ì‹œì ì¸ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",icon:"ğŸ”§",severity:"error"}:{type:"generic",title:"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",message:"ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",icon:"âš ï¸",severity:"error"}})(a),p=s<u&&n,C=m=>Math.min(1e3*Math.pow(2,m),1e4),j=async()=>{if(!(!p||t)){h(!0);try{const m=C(s);if(m>2e3){const i=Math.ceil(m/1e3)}await new Promise(i=>setTimeout(i,m)),await n()}catch(m){console.error("Retry failed:",m)}finally{h(!1)}}},S=()=>{const m="text-center";switch(x){case"compact":return`${m} py-4`;case"inline":return`${m} py-2`;default:return`${m} py-8`}},N=()=>{switch(x){case"compact":case"inline":return"text-3xl";default:return"text-5xl"}};return x==="inline"?e.jsxs("div",{className:"flex items-center justify-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("span",{className:"text-xl",children:c.icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:c.title}),e.jsx("p",{className:"text-xs text-red-600",children:c.message})]}),p&&e.jsx("button",{onClick:j,disabled:t,className:"btn-secondary text-xs px-3 py-1","aria-label":`ì¬ì‹œë„ (${s+1}/${u})`,children:t?"ì¬ì‹œë„ ì¤‘...":"ì¬ì‹œë„"})]}):e.jsx("div",{className:"card",children:e.jsxs("div",{className:S(),role:"alert","aria-live":"assertive",children:[e.jsx("div",{className:`${N()} mb-4`,"aria-hidden":"true",children:c.icon}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:c.title}),e.jsx("p",{className:"text-gray-600 mb-4 max-w-md mx-auto",children:c.message}),a&&e.jsx("button",{onClick:()=>b(!g),className:"text-sm text-gray-500 hover:text-gray-700 mb-4 underline","aria-expanded":g,"aria-controls":"error-details",children:g?"ìì„¸í•œ ë‚´ìš© ìˆ¨ê¸°ê¸°":"ìì„¸í•œ ë‚´ìš© ë³´ê¸°"}),g&&a&&e.jsxs("div",{id:"error-details",className:"bg-gray-50 border border-gray-200 rounded p-3 mb-4 text-left",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"ì˜¤ë¥˜ ì„¸ë¶€ì‚¬í•­:"}),e.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap break-words",children:a})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center",children:[p&&e.jsx("button",{onClick:j,disabled:t,className:`btn-primary ${t?"opacity-75 cursor-not-allowed":""}`,"aria-label":`ì¬ì‹œë„ (${s+1}/${u})`,children:t?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ì¬ì‹œë„ ì¤‘..."]}):`ğŸ”„ ë‹¤ì‹œ ì‹œë„ (${s+1}/${u})`}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn-secondary",children:"ğŸ”ƒ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨"})]}),s>0&&e.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:["ì¬ì‹œë„ íšŸìˆ˜: ",s,"/",u]}),e.jsx("div",{className:"mt-6 text-xs text-gray-500 max-w-lg mx-auto",children:e.jsx("p",{children:"ë¬¸ì œê°€ ì§€ì†ë˜ë©´ ë¸Œë¼ìš°ì €ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ì ì‹œ í›„ ë‹¤ì‹œ ë°©ë¬¸í•´ì£¼ì„¸ìš”."})}),e.jsxs("div",{className:"sr-only",children:["ì˜¤ë¥˜ ìœ í˜•: ",c.type,". ì‹¬ê°ë„: ",c.severity,".",p?`ì¬ì‹œë„ ê°€ëŠ¥. ë‚¨ì€ ì¬ì‹œë„ íšŸìˆ˜: ${u-s}íšŒ.`:"ì¬ì‹œë„ ë¶ˆê°€ëŠ¥."]})]})})};M.propTypes={error:d.string,onRetry:d.func,retryAttempts:d.number,maxRetries:d.number,showDetails:d.bool,variant:d.oneOf(["default","compact","inline"])};M.displayName="ErrorState";const _=({camera:a,index:n,onImageTap:s,onCardPress:u})=>{const[y,x]=r.useState(!0),[t,h]=r.useState(!1),[g,b]=r.useState(!1),o=r.useRef(null),c=r.useRef(null),p=i=>{x(!1),i.target.style.opacity="1"},C=i=>{x(!1),h(!0),i.target.src="/images/placeholder.jpg",i.target.style.opacity="0.7"},j=r.useCallback(i=>{o.current={x:i.touches[0].clientX,y:i.touches[0].clientY,time:Date.now()},b(!0),c.current=setTimeout(()=>{u&&(u(a),navigator.vibrate&&navigator.vibrate(50))},500)},[a,u]),S=r.useCallback(i=>{if(b(!1),c.current&&clearTimeout(c.current),!o.current)return;const E={x:i.changedTouches[0].clientX,y:i.changedTouches[0].clientY,time:Date.now()},T=E.x-o.current.x,w=E.y-o.current.y,R=E.time-o.current.time,k=Math.sqrt(T*T+w*w);R<300&&k<10&&s&&s(a),o.current=null},[a,s]),N=r.useCallback(()=>{b(!1),c.current&&clearTimeout(c.current),o.current=null},[]),m=r.useCallback(i=>{i.preventDefault()},[]);return e.jsxs("div",{className:`
        card transition-all duration-300 card-interactive touch-manipulation
        ${g?"scale-95 shadow-md":"hover:shadow-lg active:scale-98"}
        cursor-pointer select-none
      `,style:{animationDelay:`${n%8*50}ms`,WebkitTapHighlightColor:"transparent"},onTouchStart:j,onTouchEnd:S,onTouchCancel:N,onContextMenu:m,role:"button",tabIndex:0,"aria-label":`${a.name} ì¹´ë©”ë¼ ë³´ê¸°`,children:[e.jsxs("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden mb-3 relative group",children:[y&&e.jsx("div",{className:"absolute inset-0 skeleton flex items-center justify-center z-10",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}),e.jsx("img",{src:`${a.image.url}?t=${Date.now()}`,alt:`${a.name} ì‹¤ì‹œê°„ ì¹´ë©”ë¼`,className:"w-full h-full object-cover transition-all duration-500 group-hover:scale-105 group-active:scale-95",loading:"lazy",onLoad:p,onError:C,style:{opacity:y?"0":"1",touchAction:"manipulation"},draggable:!1}),t&&e.jsxs("div",{className:"absolute inset-0 bg-gray-100 flex flex-col items-center justify-center text-gray-500",children:[e.jsx("div",{className:"text-xl sm:text-2xl mb-2",children:"ğŸ“·"}),e.jsxs("div",{className:"text-xs text-center px-2",children:["ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜",e.jsx("br",{}),"ì—†ìŠµë‹ˆë‹¤"]})]}),e.jsxs("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full flex items-center gap-1 shadow-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"hidden xs:inline",children:"LIVE"}),e.jsx("span",{className:"xs:hidden",children:"â—"})]}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-active:bg-opacity-10 transition-all duration-200 pointer-events-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm sm:text-base mb-1 line-clamp-1 leading-tight",title:a.name,children:a.name}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mb-2 line-clamp-1 leading-relaxed",title:a.area,children:["ğŸ“ ",a.area]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 gap-2",children:[e.jsxs("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs flex-shrink-0",children:["ID: ",a.id]}),e.jsxs("span",{className:"bg-blue-50 text-blue-600 px-2 py-1 rounded text-xs flex-shrink-0",children:[a.image.width,"Ã—",a.image.height]})]})]}),e.jsx("div",{className:"absolute bottom-2 left-2 opacity-0 group-active:opacity-100 transition-opacity duration-200",children:e.jsx("div",{className:"text-xs text-gray-400 bg-white bg-opacity-80 px-2 py-1 rounded",children:"íƒ­í•˜ì—¬ ëª¨ë‹¬ ì—´ê¸°"})}),e.jsxs("div",{className:"sr-only",children:["ì‹¤ì‹œê°„ êµí†µ ì¹´ë©”ë¼: ",a.name,", ìœ„ì¹˜: ",a.area,", í•´ìƒë„: ",a.image.width,"Ã—",a.image.height,"í”½ì…€. íƒ­í•˜ì—¬ í™•ëŒ€ ëª¨ë‹¬ ì—´ê¸°, í™”ì‚´í‘œ í‚¤ë¡œ íƒìƒ‰ ê°€ëŠ¥"]})]})};_.propTypes={camera:d.shape({id:d.oneOfType([d.string,d.number]).isRequired,name:d.string.isRequired,area:d.string.isRequired,image:d.shape({url:d.string.isRequired,width:d.oneOfType([d.string,d.number]),height:d.oneOfType([d.string,d.number])}).isRequired}).isRequired,index:d.number.isRequired,onImageTap:d.func,onCardPress:d.func};const re=()=>{const[a,n]=r.useState([]),[s,u]=r.useState([]),[y,x]=r.useState(!0),[t,h]=r.useState(null),[g,b]=r.useState("all"),[o,c]=r.useState("featured"),[p,C]=r.useState(null),[j,S]=r.useState(!0),[N,m]=r.useState(0),[i,E]=r.useState(!1),[T,w]=r.useState(null),[R,k]=r.useState(0),[I,O]=r.useState(!1);r.useEffect(()=>{const l=()=>{O("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)};return l(),window.addEventListener("touchstart",l,{once:!0}),()=>{window.removeEventListener("touchstart",l)}},[]),r.useEffect(()=>{if(L(),j){const l=setInterval(L,6e4);return()=>clearInterval(l)}},[j]),r.useEffect(()=>{u(o==="featured"?se(a):o==="area"&&g!=="all"?ee(a,g):a)},[a,o,g]);const L=async(l=!1)=>{try{l?E(!0):x(!0);const f=await Q();n(f.cameras),C(new Date(f.timestamp)),h(null),m(0)}catch(f){h(f.message),m(v=>v+1)}finally{x(!1),E(!1)}},K=async()=>{await L(!1)},Y=async()=>{await L(!0)},D=r.useCallback(l=>{const f=s.findIndex(v=>v.id===l.id);w(l),k(f>=0?f:0)},[s]),q=r.useCallback(l=>{D(l)},[D]),U=r.useCallback(()=>{w(null),k(0)},[]);r.useCallback(l=>{if(!I)return;const f=["featured","area","all"],v=f.indexOf(o);l==="left"&&v<f.length-1?c(f[v+1]):l==="right"&&v>0&&c(f[v-1])},[o,I]);const W=ae(a),z=Object.keys(W).sort();return y&&a.length===0?e.jsx(P,{count:8,showControls:!0,showSummary:!0,variant:"default"}):t&&a.length===0?e.jsx(M,{error:t,onRetry:K,retryAttempts:N,maxRetries:3,showDetails:!1,variant:"default"}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"card",children:[I&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"text-sm text-blue-800",children:["ğŸ’¡ ",e.jsx("strong",{children:"í„°ì¹˜ ê°€ì´ë“œ:"})," ì¹´ë©”ë¼ë¥¼ íƒ­í•˜ì—¬ í™•ëŒ€ ë³´ê¸° (í™”ì‚´í‘œ í‚¤ë¡œ íƒìƒ‰, ESCë¡œ ë‹«ê¸°)"]})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:flex sm:gap-2",children:[e.jsx("button",{onClick:()=>c("featured"),className:`
                  px-4 py-3 sm:px-3 sm:py-2 rounded-lg text-sm sm:text-sm 
                  font-medium transition-all duration-200 touch-manipulation
                  min-h-[44px] sm:min-h-[auto] flex items-center justify-center
                  ${o==="featured"?"bg-blue-600 text-white shadow-md transform scale-105":"bg-gray-200 text-gray-700 hover:bg-gray-300 active:scale-95"}
                `,"aria-pressed":o==="featured",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"â­"}),e.jsx("span",{className:"hidden xs:inline",children:"ì£¼ìš” ì§€ì "}),e.jsx("span",{className:"xs:hidden",children:"ì£¼ìš”"})]})}),e.jsx("button",{onClick:()=>c("area"),className:`
                  px-4 py-3 sm:px-3 sm:py-2 rounded-lg text-sm sm:text-sm 
                  font-medium transition-all duration-200 touch-manipulation
                  min-h-[44px] sm:min-h-[auto] flex items-center justify-center
                  ${o==="area"?"bg-blue-600 text-white shadow-md transform scale-105":"bg-gray-200 text-gray-700 hover:bg-gray-300 active:scale-95"}
                `,"aria-pressed":o==="area",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ğŸ“"}),e.jsx("span",{className:"hidden xs:inline",children:"ì§€ì—­ë³„"}),e.jsx("span",{className:"xs:hidden",children:"ì§€ì—­"})]})}),e.jsx("button",{onClick:()=>c("all"),className:`
                  px-4 py-3 sm:px-3 sm:py-2 rounded-lg text-sm sm:text-sm 
                  font-medium transition-all duration-200 touch-manipulation
                  min-h-[44px] sm:min-h-[auto] flex items-center justify-center
                  ${o==="all"?"bg-blue-600 text-white shadow-md transform scale-105":"bg-gray-200 text-gray-700 hover:bg-gray-300 active:scale-95"}
                `,"aria-pressed":o==="all",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ğŸ—ºï¸"}),e.jsx("span",{className:"hidden xs:inline",children:"ì „ì²´"}),e.jsx("span",{className:"xs:hidden",children:"ì „ì²´"})]})})]}),I&&e.jsx("div",{className:"text-xs text-gray-500 text-center sm:text-right",children:"â† ìŠ¤ì™€ì´í”„í•˜ì—¬ ëª¨ë“œ ë³€ê²½ â†’"})]}),o==="area"&&e.jsx("div",{className:"w-full",children:e.jsxs("select",{value:g,onChange:l=>b(l.target.value),className:`
                  w-full px-4 py-3 border-2 border-gray-200 rounded-lg text-sm
                  bg-white touch-manipulation min-h-[44px] focus:border-blue-500
                  focus:ring-2 focus:ring-blue-200 transition-all duration-200
                `,"aria-label":"ì§€ì—­ ì„ íƒ",children:[e.jsx("option",{value:"all",children:"ëª¨ë“  ì§€ì—­"}),z.map(l=>e.jsxs("option",{value:l,children:[l," (",W[l].length,"ê°œ)"]},l))]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[e.jsxs("label",{className:"flex items-center gap-3 text-sm touch-manipulation min-h-[44px] cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:l=>S(l.target.checked),className:"w-5 h-5 rounded border-2 border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-200"}),e.jsx("span",{className:"select-none",children:"ìë™ ìƒˆë¡œê³ ì¹¨"})]}),e.jsx("button",{onClick:Y,disabled:y||i,className:`
                btn-secondary text-sm font-medium px-4 py-3 sm:py-2
                rounded-lg transition-all duration-200 touch-manipulation
                min-h-[44px] sm:min-h-[auto] disabled:opacity-50
                disabled:cursor-not-allowed active:scale-95
                flex items-center justify-center gap-2
              `,"aria-label":"ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"ì—…ë°ì´íŠ¸ ì¤‘..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"ğŸ”„"}),e.jsx("span",{children:"ìƒˆë¡œê³ ì¹¨"})]})})]}),p&&e.jsx("div",{className:"text-xs text-gray-500 pt-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ",p.toLocaleString("ko-KR")]}),e.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"ì‹¤ì‹œê°„"]})]})})]})]}),i&&a.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:"ì¹´ë©”ë¼ ë°ì´í„°ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ëŠ” ì¤‘..."})]})}),t&&a.length>0&&e.jsx(M,{error:t,onRetry:K,retryAttempts:N,maxRetries:3,showDetails:!1,variant:"inline"}),e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 sm:gap-4",children:s.map((l,f)=>e.jsx(_,{camera:l,index:f,onImageTap:D,onCardPress:q},l.id))}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm",children:[e.jsxs("span",{className:"text-gray-700",children:["ì´ ",e.jsx("strong",{children:a.length}),"ê°œ ì¹´ë©”ë¼ ì¤‘ ",e.jsx("strong",{children:s.length}),"ê°œ í‘œì‹œ"]}),e.jsxs("span",{className:"text-green-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"hidden sm:inline",children:"ì‹¤ì‹œê°„ (data.gov.sg API)"}),e.jsx("span",{className:"sm:hidden",children:"ì‹¤ì‹œê°„"})]})]})}),T&&e.jsx(J,{item:T,items:s,currentIndex:R,type:"traffic",onClose:U,onNavigate:l=>{k(l),w(s[l])}})]})};export{re as default};
//# sourceMappingURL=TrafficCameraGallery-6483d990.js.map
