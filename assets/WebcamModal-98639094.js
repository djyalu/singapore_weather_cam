import{P as i,r as l,j as a}from"./index-30c7ff2b.js";const k=({item:g,items:o=[],currentIndex:r=0,onClose:d,onNavigate:t,type:p="auto"})=>{const[h,u]=l.useState(!1),[N,b]=l.useState(!0),[C,y]=l.useState(!1),[n,T]=l.useState(!1),f=l.useRef(null),D=l.useRef(null);l.useEffect(()=>{(()=>{T("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)})()},[]);const E=(e=>{var c;return p!=="auto"?p:(c=e==null?void 0:e.image)!=null&&c.url?"traffic":(e!=null&&e.file_info||e!=null&&e.imageUrl,"webcam")})(g),s=((e,c)=>{var x,j,w;if(c==="traffic")return{id:e.id,name:e.name,location:e.area,imageUrl:`${e.image.url}?t=${Date.now()}`,metadata:{id:e.id,resolution:`${e.image.width}×${e.image.height}`,area:e.area,type:"Traffic Camera"},lastUpdated:new Date().toISOString()};{const v="/singapore_weather_cam/",S=e.imageUrl||((x=e.file_info)==null?void 0:x.url)||((j=e.file_info)==null?void 0:j.source_url)||((w=e.file_info)!=null&&w.path?`${v}${e.file_info.path}`:null)||`${v}images/placeholder.jpg`;return{id:e.id,name:e.name,location:e.location,imageUrl:S,coordinates:e.coordinates,analysis:e.ai_analysis||e.analysis,metadata:{type:e.type||"Webcam",captureTime:e.capture_time,...e.file_info&&{fileInfo:e.file_info}},lastUpdated:e.capture_time||e.lastUpdated}}})(g,E),m=o.length>1;l.useEffect(()=>{f.current&&f.current.focus()},[]),l.useEffect(()=>{const e=c=>{switch(c.key){case"Escape":d();break;case"ArrowLeft":m&&r>0&&(t==null||t(r-1));break;case"ArrowRight":m&&r<o.length-1&&(t==null||t(r+1));break;case"z":case"Z":n||u(x=>!x);break}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[d,t,m,r,o.length,n]);const _=l.useCallback(e=>{e.target===e.currentTarget&&d()},[d]),z=l.useCallback(()=>{b(!1),y(!1)},[]),$=l.useCallback(()=>{b(!1),y(!0)},[]),I=l.useCallback(()=>{n||u(e=>!e)},[n]),U=l.useCallback(e=>{e.touches.length===2&&u(!0)},[]);return a.jsx("div",{ref:f,className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-2 sm:p-4",onClick:_,tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",style:{WebkitTapHighlightColor:"transparent"},children:a.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[95vh] overflow-hidden animate-fade-in shadow-2xl",children:[a.jsxs("div",{className:"p-3 sm:p-4 border-b flex items-center justify-between bg-gray-50",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{id:"modal-title",className:"text-lg sm:text-xl font-semibold truncate",children:s.name}),a.jsxs("p",{className:"text-sm text-gray-600 truncate",children:["📍 ",s.location]})]}),m&&a.jsxs("div",{className:"flex items-center gap-2 mx-4",children:[a.jsx("button",{onClick:()=>t==null?void 0:t(r-1),disabled:r===0,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Previous image",children:"←"}),a.jsxs("span",{className:"text-sm text-gray-600 min-w-fit",children:[r+1," / ",o.length]}),a.jsx("button",{onClick:()=>t==null?void 0:t(r+1),disabled:r===o.length-1,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Next image",children:"→"})]}),a.jsx("button",{onClick:d,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded-full transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center","aria-label":"Close modal",children:"✕"})]}),a.jsxs("div",{className:"relative bg-gray-100",children:[N&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}),a.jsx("div",{className:`
              overflow-auto max-h-[60vh] sm:max-h-[70vh]
              ${h?"cursor-zoom-out":"cursor-zoom-in"}
              ${n?"":"hover:opacity-90"}
            `,onTouchStart:n?U:void 0,children:a.jsx("img",{ref:D,src:s.imageUrl,alt:`${s.name} view`,className:`
                w-full transition-all duration-300
                ${h?"scale-150 sm:scale-200":"scale-100"}
                ${n?"":"hover:scale-105"}
              `,style:{transformOrigin:"center center",touchAction:n?"pinch-zoom":"none"},loading:"lazy",onLoad:z,onError:$,onClick:I,draggable:!1})}),C&&a.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-100 text-gray-500",children:[a.jsx("div",{className:"text-4xl mb-2",children:"📷"}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{children:"이미지를 불러올 수 없습니다"}),a.jsx("p",{className:"text-sm mt-1",children:"Image failed to load"})]})]}),!n&&!h&&a.jsx("div",{className:"absolute top-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:"Click to zoom (Z)"}),n&&a.jsx("div",{className:"absolute top-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:"Pinch to zoom"})]}),a.jsxs("div",{className:"p-3 sm:p-4 overflow-y-auto max-h-[25vh] space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"위치 정보 / Location Details"}),a.jsx("p",{className:"text-gray-600 mb-2",children:s.location}),s.coordinates&&a.jsxs("p",{className:"text-sm text-gray-500",children:["좌표: ",s.coordinates.lat,", ",s.coordinates.lng]}),a.jsxs("div",{className:"mt-3 space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:s.metadata.type}),s.metadata.resolution&&a.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs",children:s.metadata.resolution})]}),s.metadata.id&&a.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",s.metadata.id]})]})]}),s.analysis&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"AI 분석 / AI Analysis"}),a.jsx("p",{className:"text-gray-700 mb-2 text-sm",children:s.analysis.description}),s.analysis.tags&&a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:s.analysis.tags.map((e,c)=>a.jsx("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded",children:e},c))}),s.analysis.weatherCondition&&a.jsxs("p",{className:"text-sm text-gray-600",children:["날씨: ",s.analysis.weatherCondition]})]})]}),a.jsx("div",{className:"pt-3 border-t border-gray-200",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm text-gray-500",children:[a.jsxs("span",{children:["마지막 업데이트: ",s.lastUpdated?new Date(s.lastUpdated).toLocaleString("ko-KR"):"Unknown"]}),m&&a.jsx("span",{className:"text-xs",children:"키보드: ← → (탐색), ESC (닫기), Z (확대)"})]})})]})]})})};k.propTypes={item:i.object.isRequired,items:i.array,currentIndex:i.number,onClose:i.func.isRequired,onNavigate:i.func,type:i.oneOf(["webcam","traffic","auto"])};k.defaultProps={items:[],currentIndex:0,onNavigate:null,type:"auto"};export{k as W};
//# sourceMappingURL=WebcamModal-98639094.js.map
